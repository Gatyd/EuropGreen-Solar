{% extends 'emails/base.html' %}

{% block title %}Rappel urgent : TÃ¢che dans {{ hours_remaining }}h - EuropGreen Solar{% endblock %}

{% block content %}
<div style="margin-bottom: 32px;">
    <h1 style="color: #dc2626; font-size: 24px; font-weight: 600; margin: 0 0 8px 0;">
        âš ï¸ Rappel urgent : TÃ¢che imminente
    </h1>
    <p style="color: #6b7280; font-size: 14px; margin: 0;">
        Votre tÃ¢che commence dans <strong style="color: #dc2626;">{{ hours_remaining }} heure{{ hours_remaining|pluralize }}</strong>
    </p>
</div>

<!-- Carte de la tÃ¢che -->
<div style="background-color: #fee2e2; border-left: 4px solid #dc2626; border-radius: 8px; padding: 24px; margin-bottom: 24px;">
    
    <!-- Titre et prioritÃ© -->
    <div style="margin-bottom: 16px;">
        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px;">
            <h2 style="color: #1f2937; font-size: 20px; font-weight: 600; margin: 0;">
                {{ task.title }}
            </h2>
            {% if task.priority == 'urgent' %}
            <span style="background-color: #991b1b; color: #ffffff; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                ğŸ”´ Urgente
            </span>
            {% elif task.priority == 'high' %}
            <span style="background-color: #ea580c; color: #ffffff; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                ğŸŸ  Haute prioritÃ©
            </span>
            {% elif task.priority == 'normal' %}
            <span style="background-color: #2563eb; color: #ffffff; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                ğŸ”µ Normale
            </span>
            {% else %}
            <span style="background-color: #6b7280; color: #ffffff; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                âšª Basse
            </span>
            {% endif %}
        </div>
    </div>

    {% if task.description %}
    <!-- Description -->
    <div style="margin-bottom: 16px;">
        <p style="color: #374151; font-size: 14px; line-height: 1.6; margin: 0; white-space: pre-wrap;">{{ task.description }}</p>
    </div>
    {% endif %}

    <!-- Heure exacte -->
    <div style="background-color: #ffffff; border-radius: 6px; padding: 16px; margin-bottom: 12px;">
        <div style="text-align: center;">
            <span style="color: #dc2626; font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">â° Heure de dÃ©but</span>
            <span style="color: #1f2937; font-size: 24px; font-weight: 700;">
                {{ task.due_time|time:"H:i" }}
            </span>
            <span style="color: #6b7280; font-size: 14px; display: block; margin-top: 4px;">
                {{ task.due_date|date:"l d F Y" }}
            </span>
        </div>
    </div>

    {% if task.related_installation %}
    <!-- Installation liÃ©e -->
    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #fca5a5;">
        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px;">
            <span style="color: #991b1b; font-size: 13px; font-weight: 500;">ğŸ  Installation liÃ©e</span>
            <a href="{{ frontend_url }}/home/installations/{{ task.related_installation.id }}" 
               style="display: inline-block; background-color: #10b981; color: #ffffff; text-decoration: none; padding: 6px 16px; border-radius: 6px; font-size: 13px; font-weight: 500; transition: background-color 0.2s;">
                Voir l'installation
            </a>
        </div>
    </div>
    {% endif %}

</div>

<!-- Message d'urgence -->
<div style="background-color: #fef3c7; border-radius: 8px; padding: 20px; margin-bottom: 24px; text-align: center; border: 2px solid #f59e0b;">
    <p style="color: #92400e; font-size: 16px; line-height: 1.6; margin: 0 0 12px 0; font-weight: 600;">
        âš¡ Action requise immÃ©diatement !
    </p>
    <p style="color: #6b7280; font-size: 14px; margin: 0;">
        Assurez-vous d'avoir tout le nÃ©cessaire pour accomplir cette tÃ¢che.<br>
        En cas de problÃ¨me, contactez votre responsable dÃ¨s maintenant.
    </p>
</div>

<!-- Bouton d'action -->
<div style="text-align: center; margin: 32px 0;">
    <a href="{{ frontend_url }}/home/calendar" 
       style="display: inline-block; background-color: #dc2626; color: #ffffff; text-decoration: none; padding: 14px 36px; border-radius: 8px; font-weight: 600; font-size: 16px; box-shadow: 0 4px 6px -1px rgba(220, 38, 38, 0.4);">
        ğŸš€ AccÃ©der Ã  la tÃ¢che
    </a>
</div>

<!-- Informations supplÃ©mentaires -->
<div style="background-color: #f9fafb; border-radius: 8px; padding: 16px; margin-top: 24px; border-left: 4px solid #6b7280;">
    <p style="color: #4b5563; font-size: 13px; line-height: 1.5; margin: 0;">
        <strong>ğŸ“Œ Note :</strong> Ce rappel est envoyÃ© automatiquement 3 heures avant l'Ã©chÃ©ance. 
        Une fois la tÃ¢che terminÃ©e, pensez Ã  la marquer comme complÃ©tÃ©e dans votre calendrier.
    </p>
</div>

{% endblock %}

{% block footer_content %}
<div style="margin-bottom: 16px;">
    <p style="color: #1f2937; font-weight: 500; font-size: 14px; margin-bottom: 4px; margin-top: 0;">
        EuropGreen Solar
    </p>
    <p style="color: #6b7280; font-size: 12px; margin: 0;">
        SystÃ¨me de rappels automatiques
    </p>
</div>

<div style="border-top: 1px solid #d1d5db; padding-top: 16px;">
    <p style="color: #6b7280; font-size: 12px; margin: 0;">
        Ce rappel urgent est envoyÃ© pour vous aider Ã  ne manquer aucune Ã©chÃ©ance.<br>
        Pour toute question, contactez votre administrateur.
    </p>
</div>
{% endblock %}
